# Git Workflow Tool v1.31

# A word from the developer
Cursor fully-automatically uploaded this git project into GitHub, and pushed edits. Using itself. Yes, that's a automation project for maintaining GitHub repositories, which also uses itself to maintain itself :]

p.s. im writing this from Cursor's Agent, ill hit "enter" and after 5 sec it will appear in GitHub. 

# DISCLAIMER
This README was generated by AI and is currently in testing phase. The content might be faulty or incomplete. Please verify all instructions before use.

## For Humans
1. Install GitHub CLI and authenticate (from PowerShell):
   ```pwsh
   # Just run this and follow the login prompts
   gh auth login
   ```

2. Add these rules to your Cursor Settings -> Rules -> User Rules:
```
Git operations (GitWorkflow)
a) 
      For any git-related operations: First check for .cursor/rules/ for "use_gitworkflow.mdc" or "no_gitworkflow.mdc" in the project. 
    If(neither exists){
       nested if(i explicitly told "don't use GitWorkflow"){
           do "/Generate Cursor Rules"  no_gitworkflow.mdc with text "don't use GitWorkflow" and "description: anything git related"
    }else{
       a1) if you are not Claude's LLM model - give exactly that warning to me: "GitWorkflow strongly suggests to run the initial setup using Claude. GPT4.1 is known to skip steps, Gemini2.5 too."  and wait for user before you do anything else.
       a2) open and fully read (critical to do it before doing anything else) https://github.com/ArtyMcLabin/GitWorkflow/README.md and 
           follow its instructions.
    }
}

b) Github Issue Creation 
For GitHub issue creation: Follow the standardized format defined in https://github.com/ArtyMcLabin/GitWorkflow/github_issues_workflow.md This ensures consistent issue formatting, proper labeling, and cross-repository support.

c) Before initiating a new git remote, check if we already are connected to some remote
```

That's it! GitWorkflow will now handle all your git operations automatically.

## Features
- Automatic repository initialization
- Standardized file structure
- Duplicate repository prevention
- Version tracking
- GitHub integration
- Cursor IDE support
- Auto-updates when used as submodule
- Standardized issue creation for any repository
- Secure auto-update system with malicious code detection

## Security Features
GitWorkflow includes a secure auto-update system that protects users from potentially malicious updates:

1. Automatic Security Checks:
   - Detects new executable or script files
   - Scans for suspicious PowerShell commands
   - Monitors for unusually large changes
   - Validates file modifications

2. User Control:
   - Warns about potentially dangerous changes
   - Allows viewing exact changes before applying
   - Provides option to skip suspicious updates
   - Never applies risky updates without permission

3. Protected Operations:
   - System modifications
   - Network configurations
   - File system operations
   - Windows Registry changes
   - Security policy modifications

## Sub-Workflows

### Issue Creation Workflow
GitWorkflow provides a standardized way to create well-formatted issues in any GitHub repository (both GitWorkflow itself and any other repository):

1. Issue Creation Parameters:
   - `-CreateIssue`: Switch to enable issue creation mode
   - `-IssueTitle`: Title of the issue (required)
   - `-IssueBody`: Description of the issue (optional)
   - `-IssueLabels`: Array of labels to apply (optional)
   - `-IssueRepo`: Target repository in format "owner/repo" (optional, defaults to current repo)

2. Formatting Features:
   - Automatic markdown table formatting for issue body
   - Proper escaping of special characters
   - Support for multi-line descriptions
   - Label validation against repository's available labels
   - Cross-repository issue creation support

3. Usage Examples:
   ```pwsh
   # Create issue in current repository
   git_workflow.ps1 -CreateIssue -IssueTitle "Bug Report" -IssueBody "Description of the bug"

   # Create issue in another repository
   git_workflow.ps1 -CreateIssue -IssueTitle "Feature Request" -IssueBody "New feature needed" -IssueRepo "owner/repo"

   # Create labeled issue in another repository
   git_workflow.ps1 -CreateIssue -IssueTitle "Enhancement" -IssueBody "Improvement idea" -IssueRepo "owner/repo" -IssueLabels @("enhancement")

   # Example: Project1 creating issue in Project2's repository
   git_workflow.ps1 -CreateIssue -IssueTitle "Integration Bug" -IssueBody "Found issue while using Project2 as submodule" -IssueRepo "owner/project2"
   ```

4. Where It Works:
   - In GitWorkflow's own repository
   - In any repository using GitWorkflow as a submodule
   - In any repository with a symbolic link to GitWorkflow
   - Can create issues in ANY public GitHub repository (with proper permissions)

### Issue Management Workflow
GitWorkflow provides a standardized way to manage issues across GitHub repositories:

1. Issue Creation Parameters:
   - `-CreateIssue`: Switch to enable issue creation mode
   - `-IssueTitle`: Title of the issue (required)
   - `-IssueBody`: Description of the issue (optional)
   - `-IssueLabels`: Array of labels to apply (optional)
   - `-IssueRepo`: Target repository in format "owner/repo" (optional, defaults to current repo)

2. Issue Approval Parameters:
   - `-ApproveIssue`: Switch to approve an issue
   - `-IssueNumber`: Number of the issue to approve
   - `-IssueRepo`: Target repository (if not current)

3. Issue Resolution Parameters:
   - `-CloseIssue`: Switch to close an issue as resolved
   - `-IssueNumber`: Number of the issue to close
   - `-Implementation`: Link to implementation (commit/PR)
   - `-IssueRepo`: Target repository (if not current)

4. Standard Labels:
   - `ai-generated`: Automatically added to issues created by GitWorkflow
   - `human-approved-request`: Added when a human approves an issue request
   - `ai-implemented`: Added when AI resolves and closes an issue
   - `needs-human-review`: Can be added by users if human review needed

5. Usage Examples:
   ```pwsh
   # Create issue in current repository
   git_workflow.ps1 -CreateIssue -IssueTitle "Bug Report" -IssueBody "Description of the bug"

   # Create issue in another repository
   git_workflow.ps1 -CreateIssue -IssueTitle "Feature Request" -IssueBody "New feature needed" -IssueRepo "owner/repo"

   # Approve an issue
   git_workflow.ps1 -ApproveIssue -IssueNumber "42" -IssueRepo "owner/repo"

   # Close a resolved issue
   git_workflow.ps1 -CloseIssue -IssueNumber "42" -Implementation "https://github.com/owner/repo/pull/43"
   ```

6. Standard Messages:
   - Issue Creation: Includes AI attribution header
   - Human Approval: Includes approver name and timestamp
   - Issue Resolution: Includes implementation details and feedback instructions

## Project Rules
1. GitWorkflow Presence Check Rule (CRITICAL):
   - BEFORE ANY git operations, ALWAYS check for GitWorkflow presence:
     a) Look for `.git_workflow` directory
     b) Check `.git/config` for submodule
     c) Look for `.git_workflow` symbolic link
   - If found: Use the existing installation
   - If not found: Add as submodule or symlink
   - NEVER initialize git if GitWorkflow or .git already exists

2. Git Operations Rule:
   - ALWAYS use GitWorkflow (`git_workflow.ps1`) for ANY git operations
   - NEVER use raw git commands directly unless explicitly approved by human
   - If an operation is not supported by GitWorkflow:
     a) STOP - do not use raw git commands
     b) Report to user: "Human, operation X is not defined in GitWorkflow. Should we add it officially?"
     c) If human explicitly approves using raw git commands - proceed with warning
     d) If not - wait for implementation in GitWorkflow before proceeding

## Version History

### Architecture & Rules
- v1.29: Improved issue workflow
   - Created github_issues_workflow.md in root
   - Added github_issues.mdc rule reference
   - Removed script dependency from user rules
   - Separated user rules into distinct copyable blocks
- v1.28: Simplified project rules
   - Reduced duplication in setup_rules.ps1
   - Improved reference to AI instructions in README.md
   - Streamlined runtime rules for AI agents
- v1.26: Restructured rule system
   - Simplified user rule to single source of truth
   - Moved operational instructions to project-level rules
   - Added clear setup instructions for AI agents
   - Improved rule creation and management

### Security & Updates
- v1.25: Added secure auto-update system
   - Added malicious code detection
   - Implemented user-controlled update process
   - Added security checks for suspicious changes
   - Protected against potentially harmful updates
- v1.27: Fixed license issues
   - Fixed license year and copyright holder in both primary and fallback methods
   - Fixed license year to always use current year
   - Added Cursor User Rule for Issue Creation

### Repository Status & Submodule Handling
- v1.24: Added mandatory GitWorkflow presence check rule
   - Added .cursor/rules/check_gitworkflow.mdc
   - Updated documentation with prominent presence check requirements
   - Prevents accidental repository reinitialization
- v1.23: Added robust git status checking to prevent repository reinitialization issues
   - Added git_status_check.ps1 for comprehensive repository state detection
   - Improved handling of existing repositories and remotes
   - Better submodule detection and management
   - Added automatic cloning for existing remote repositories

### Issue Management & Automation
- v1.22: Added automatic issue linking in commit messages with "Closes #X" syntax
- v1.21: Changed 'human-approved' label to more specific 'human-approved-request'
- v1.20: Enhanced issue management with standard messages, labels, and workflows
- v1.19: Added cross-repository issue creation support
- v1.18: Fixed repository messages, improved file removal, added standardized issue creation

### Documentation & UI
- v1.17: Added instructions for integrating GitWorkflow into existing GitHub projects
- v1.16: Updated Project Rules to use generic "Human" reference and allow explicit overrides
- v1.15: Added Project Rules section with strict GitWorkflow usage rule
- v1.14: Fixed repository URL display in creation feedback
- v1.13: Added detailed repository creation feedback requirements
- v1.12: Simplified Cursor settings instruction
- v1.11: Improved AI instructions section formatting in README

### File Management & Cleanup
- v1.10: Added automatic cleanup of unnecessary files (desktop.ini, .github_info)
- v1.9: Removed deprecated files (git_workflow.md and examples directory)
- v1.8: Enhanced error handling and submodule updates
- v1.7: Fetch license online, removed version.txt
- v1.6: Added license handling and improved formatting

### Core Features
- v1.5: Added AI disclaimer to generated project READMEs
- v1.4: Improved documentation clarity, removed redundant sections
- v1.3: Standardized on master branch
- v1.2: Added auto-update feature for submodules
- v1.1: Added versioning rules and documentation updates
- v1.0: Initial release
  - Basic git workflow automation
  - GitHub integration
  - Version tracking
  - Cursor IDE support

---

## ðŸ¤– AI Agent Instructions

> The following sections are for AI agents only. Human users should refer to the sections above.

## Prerequisites
- PowerShell Core (pwsh)
- Git
- GitHub CLI (gh)

## Project Structure
```
GitWorkflow/
â”œâ”€â”€ README.md           # Documentation and instructions
â”œâ”€â”€ git_workflow.ps1    # Main script
â”œâ”€â”€ setup_rules.ps1     # Rules setup script
â””â”€â”€ LICENSE            # MIT License
```

## Initial Setup Instructions
When setting up GitWorkflow in a client project:

1. First, verify no GitWorkflow rules exist:
   ```pwsh
   Test-Path ".cursor/rules/use_gitworkflow.mdc"
   Test-Path ".cursor/rules/no_gitworkflow.mdc"
   ```

2. Add GitWorkflow as a submodule:
   ```pwsh
   git submodule add https://github.com/ArtyMcLabin/GitWorkflow.git .git_workflow
   ```

3. do "/Generate Cursor Rules" for use_gitworkflow.mdc with these content:
   ```markdown
   ---
   description: anything git related
   globs:
   alwaysApply: false
   ---
   This project uses GitWorkflow for all git operations.

   1) Git Operations:
      - ALWAYS use `.git_workflow/git_workflow.ps1` for ANY git operations
      - NEVER use raw git commands unless explicitly approved by human
      - If operation not supported by GitWorkflow:
        a) STOP - do not use raw git commands
        b) Report to user: "Human, operation X is not defined in GitWorkflow. Should we add it officially?"
        c) Only proceed with raw git if explicitly approved

   2) Repository Operations:
      - Check for updates before operations: `.git_workflow/git_workflow.ps1`
      - Follow security warnings if shown
      - Use standard commit message format
      - Always include issue references if applicable

   3) Issue Management:
      - Use GitWorkflow's issue creation system
      - Follow standard labeling conventions
      - Use proper issue templates
      - Link commits to issues when resolving

   4) Security:
      - Review security warnings during updates
      - Never bypass security checks without user approval
      - Report suspicious changes to repository owner
   ```

4. Initialize repository if needed:
   - Create README.md with project description
   - Set master as default branch
   - Add standard .gitignore

5. Use the workflow script for all operations:
   ```pwsh
   .git_workflow/git_workflow.ps1 -CommitMessage "Your message"
   ```

## Repository Creation Steps
When user requests to "upload it to github":

1. Ask the user:
   - "What name would you like to use for the GitHub repository?"
   - "Should the repository be public or private?"
   - "Should I add MIT license (suggested)? Or would you prefer a different license?"

2. Create the repository:
   ```pwsh
   .git_workflow/git_workflow.ps1 -CommitMessage "Initial commit"
   ```

3. Confirm and display:
   ```
   Repository successfully created at: https://github.com/username/repo-name
   âœ“ Repository creation successful
   âœ“ Code pushed successfully
   ```

## Usage Examples
```pwsh
# Initialize new repository
git_workflow.ps1

# Update existing repository with commit message
git_workflow.ps1 -CommitMessage "Your commit message"

# Create a new issue
git_workflow.ps1 -CreateIssue -IssueTitle "Bug Report" -IssueBody "Description of the bug" -IssueLabels @("bug")

# Remove a file (properly removes from both git and filesystem)
git_workflow.ps1 -RemoveFile "path/to/file"
```

## Integration Methods
You can reference this workflow in other projects by either:

1. Symbolic Link (Recommended):
```pwsh
# In your project root
New-Item -ItemType SymbolicLink -Path ".git_workflow" -Target "path\to\GitWorkflow"
# Set up GitWorkflow rules
.git_workflow/setup_rules.ps1
```

2. Git Submodule:
```pwsh
# Add GitWorkflow as a submodule
git submodule add https://github.com/ArtyMcLabin/GitWorkflow.git .git_workflow
# Set up GitWorkflow rules
.git_workflow/setup_rules.ps1
```

IMPORTANT: After adding GitWorkflow using either method, ALWAYS run the `setup_rules.ps1` script. This ensures that Cursor AI will be aware of GitWorkflow's presence in new conversations.

## Adding GitWorkflow to Existing GitHub Projects
If you're an AI Agent integrating GitWorkflow into an existing GitHub project, follow these steps:

1. First, verify you're in the correct project directory (not GitWorkflow itself)
2. Add GitWorkflow as a submodule:
   ```pwsh
   git submodule add https://github.com/ArtyMcLabin/GitWorkflow.git .git_workflow
   ```
3. Set up GitWorkflow rules:
   ```pwsh
   .git_workflow/setup_rules.ps1
   ```
4. Add these rules to the project's README.md under "Development Guidelines" or similar section:
   ```markdown
   ## Git Workflow
   This project uses GitWorkflow for standardized git operations.
   - ALWAYS use `.git_workflow/git_workflow.ps1` for git operations
   - NEVER use raw git commands unless explicitly approved
   ```
5. Create initial commit with GitWorkflow integration:
   ```pwsh
   .git_workflow/git_workflow.ps1 -CommitMessage "Added GitWorkflow integration"
   ```
6. From this point forward, use `git_workflow.ps1`
